pdf('RSeQCresults/duplication_profile/SRR3414635.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,399,400,401,402,403,404,406,407,409,410,411,412,413,414,415,416,418,419,421,422,423,424,425,426,427,428,430,431,432,433,434,435,436,437,438,441,442,444,445,446,447,448,449,451,453,454,455,456,459,460,462,463,464,465,466,468,469,470,471,472,473,474,475,476,477,478,479,481,482,483,485,486,487,488,489,491,494,495,496,498,499,504,505,506,507,509,511,515,517,519,520,525,526,527,530,532,533,535,537,543,544,546,550,551,553,554,557,559,562,563,564,565,566,567,569,571,572,573,576,581,587,588,592,595,601,602,603,604,605,614,617,621,628,632,636,638,639,641,644,646,647,649,650,652,655,657,660,663,670,673,674,682,684,686,688,692,694,698,706,717,718,725,729,741,747,752,765,769,779,781,796,799,801,803,805,821,831,837,849,850,866,873,878,883,885,890,894,899,946,958,961,983,987,988,994,1000,1006,1025,1055,1093,1135,1136,1208,1239,1303,1323,1324,1405,1450,1456,1709,1829,1921,1924,2301)
seq_uniqRead=c(6527145,1123777,444363,230375,136911,89262,61824,45067,34256,26104,21019,17014,14083,11593,9831,8474,7177,6422,5497,4951,4456,3926,3560,3097,2962,2581,2428,2203,2028,1909,1748,1610,1535,1457,1310,1215,1176,1062,1064,962,888,825,839,788,694,643,634,619,585,564,577,487,499,464,454,424,427,410,368,373,377,348,340,326,304,270,275,260,271,249,250,239,225,233,210,220,208,194,214,172,206,178,175,154,120,127,167,163,126,151,138,131,140,106,128,120,130,114,116,100,112,106,107,87,79,80,87,91,82,104,101,83,69,83,72,81,66,66,88,57,56,57,73,82,69,60,64,50,55,55,45,53,50,50,48,40,53,50,32,53,42,44,48,48,47,41,44,41,43,46,39,31,37,43,30,29,32,44,37,38,33,28,26,22,31,36,26,26,21,30,36,31,23,41,28,25,25,26,28,17,15,28,26,14,21,19,19,16,26,27,29,25,19,14,21,24,15,22,11,19,23,15,21,21,19,16,17,17,16,23,7,12,12,15,12,15,14,12,12,12,9,12,11,9,11,12,13,11,13,6,14,6,7,7,11,13,13,12,12,8,11,8,9,9,8,10,8,9,9,6,7,8,11,10,10,8,5,5,8,8,8,11,10,6,7,10,11,10,11,8,5,10,6,6,8,8,4,6,12,11,8,6,3,10,6,14,7,3,5,4,2,3,6,10,3,1,2,4,7,5,3,4,7,5,1,6,10,4,5,3,4,5,2,5,3,3,6,8,2,7,4,5,5,7,10,4,3,3,1,4,1,4,3,5,4,5,1,2,5,3,6,4,2,2,3,4,2,1,2,3,4,3,5,8,4,5,6,4,4,3,2,1,2,4,6,3,4,2,3,3,3,4,3,2,3,4,4,2,4,3,2,6,1,3,2,5,3,3,2,2,2,2,1,1,2,1,1,2,4,1,3,3,2,2,1,5,2,4,2,3,2,2,2,5,1,3,1,1,1,1,1,4,2,2,4,3,4,2,2,2,1,1,2,2,1,2,3,1,1,1,1,1,3,1,2,1,1,1,1,1,2,4,2,1,3,1,2,2,1,1,1,1,3,1,3,3,4,2,1,1,1,1,2,3,1,1,1,1,2,3,2,3,1,1,1,1,1,1,2,3,1,1,2,1,1,1,3,3,1,3,3,1,1,2,1,1,1,2,1,1,1,3,1,1,1,1,3,1,1,1,1,2,1,2,2,1,2,1,1,3,1,1,2,1,1,1,1,5,1,1,1,1,3,1,1,3,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,423,424,425,426,427,428,429,430,431,432,434,436,437,438,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,458,459,462,463,464,465,466,467,468,470,471,472,473,476,477,478,479,480,482,483,484,485,486,487,489,490,491,492,494,496,497,498,499,500,501,503,504,505,506,509,510,512,513,514,515,516,519,521,522,523,524,525,526,527,528,529,534,539,540,541,542,545,546,547,548,551,552,553,556,557,558,560,564,565,566,568,569,573,575,576,579,581,583,585,586,587,589,590,591,593,594,600,601,604,605,606,611,614,615,618,620,623,626,627,628,630,632,633,637,638,645,651,652,655,661,665,666,667,668,669,670,671,676,677,679,680,682,685,686,689,690,694,697,698,699,700,703,711,714,717,720,726,728,745,750,752,753,764,775,785,793,797,804,808,816,820,829,835,840,866,867,877,883,892,895,896,906,911,913,922,925,926,939,981,990,996,1007,1012,1027,1042,1055,1059,1069,1120,1125,1177,1262,1307,1362,1380,1434,1457,1497,1503,1767,1880,1970,1991,2357)
pos_uniqRead=c(5801076,1155843,462871,242165,144400,94683,65552,48073,36369,27703,22442,18255,14852,12639,10480,9059,7681,6841,5842,5395,4801,4202,3709,3407,3177,2816,2577,2379,2091,2035,1923,1719,1614,1514,1486,1250,1236,1180,1113,1077,964,866,875,811,822,737,716,617,615,578,561,583,540,469,498,460,441,455,404,374,381,387,345,340,311,303,324,317,289,266,281,259,233,241,245,217,211,207,226,196,197,198,182,177,188,169,160,150,148,156,122,128,135,148,133,137,104,118,127,115,121,110,108,136,88,90,111,85,86,90,85,93,86,95,72,88,77,72,78,71,65,92,56,79,60,67,65,71,58,54,68,76,49,47,56,47,48,55,46,39,54,43,39,45,47,39,47,43,51,40,40,31,42,49,32,48,43,32,32,31,35,48,29,32,29,28,44,42,30,22,31,25,34,28,22,26,28,30,38,27,26,22,24,24,31,19,27,27,23,14,20,23,20,21,23,12,20,32,23,28,25,21,18,16,19,12,17,13,25,15,25,15,19,18,15,19,19,12,20,16,12,14,17,22,6,9,17,10,13,4,16,17,12,6,8,11,14,9,5,14,12,6,6,13,5,18,3,10,12,9,11,10,7,9,9,9,9,11,12,8,12,11,10,3,12,8,7,8,10,7,7,6,12,6,12,16,9,7,8,5,7,7,10,3,8,12,5,8,4,7,7,8,7,7,5,7,9,8,7,7,3,10,5,6,4,6,3,5,8,3,3,1,7,4,6,6,8,1,5,5,3,4,8,5,1,5,2,6,3,11,5,6,8,3,3,4,5,2,5,2,3,3,3,4,3,6,3,5,4,3,1,4,4,3,8,2,2,5,4,6,1,1,2,4,3,6,6,2,1,5,5,6,2,2,3,3,5,1,3,5,1,5,5,2,3,2,7,3,5,1,3,4,4,2,2,1,2,2,4,1,3,4,2,2,4,1,3,3,4,1,1,2,1,4,1,4,3,2,3,1,1,2,1,2,3,4,2,2,2,2,3,2,6,2,1,3,1,1,2,3,2,3,2,2,1,1,1,3,1,1,2,2,1,1,2,1,1,3,1,2,1,1,1,3,1,1,1,4,1,1,1,1,3,3,1,3,1,2,3,3,2,1,2,2,1,1,1,1,2,2,2,1,2,2,1,1,1,2,1,3,1,1,3,2,2,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,3,2,4,2,1,1,1,1,2,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,3,1,1,1,1,2,1,1,1,1,1,1,2,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
