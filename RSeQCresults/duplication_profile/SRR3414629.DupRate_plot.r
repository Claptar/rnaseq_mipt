pdf('RSeQCresults/duplication_profile/SRR3414629.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,341,342,343,344,345,346,347,348,349,351,353,354,355,356,357,358,359,360,362,363,364,365,366,367,368,370,371,372,373,374,375,377,378,379,380,381,382,383,384,385,386,388,389,390,392,393,394,395,396,397,399,400,401,402,403,404,405,408,410,411,412,413,414,416,417,418,419,421,422,424,425,426,427,428,429,431,432,433,434,435,436,437,439,440,441,443,445,446,447,448,450,456,458,459,460,462,463,465,470,471,475,476,477,478,481,482,483,485,486,490,492,493,495,496,497,498,502,505,509,510,515,516,517,520,522,523,524,525,526,529,530,534,540,543,544,545,547,549,550,554,557,569,570,572,574,576,581,587,589,591,592,593,594,599,600,601,603,605,607,608,611,615,618,620,626,631,632,634,638,646,656,657,665,666,668,674,676,685,690,696,697,704,708,713,718,719,721,723,735,739,742,745,748,751,753,756,757,770,771,779,791,801,809,811,827,846,855,868,872,877,879,899,904,973,1007,1019,1032,1033,1045,1081,1124,1157,1215,1216,1237,1244,1346,1360,1427,1461,1496,1520,1543,1554,2035,2123,2139,2306,2457)
seq_uniqRead=c(6979738,1182791,463996,238411,140749,90250,62161,45133,33795,26043,20402,16478,13470,11012,9375,8026,6770,5896,5271,4532,3935,3588,3242,2853,2548,2333,2099,1982,1794,1605,1483,1379,1345,1280,1124,1021,969,846,899,813,730,691,673,676,580,597,489,527,454,468,422,438,382,384,394,365,335,311,300,279,306,264,278,262,227,216,248,234,201,201,203,162,165,172,170,179,173,154,152,155,135,128,123,152,109,125,130,115,107,104,112,102,90,93,93,96,74,87,85,86,78,58,78,81,70,69,70,65,71,56,65,66,70,55,65,62,54,46,53,44,61,48,42,56,41,43,54,36,43,36,31,43,33,45,45,43,39,28,40,42,37,40,38,28,37,36,25,41,30,23,28,30,25,26,33,20,30,36,24,33,29,24,16,21,19,19,25,20,22,22,13,14,25,17,18,12,17,20,19,13,18,23,15,18,15,21,18,11,15,18,16,14,7,17,15,15,13,12,12,9,14,11,10,14,14,8,11,12,10,17,20,8,15,12,7,6,8,9,10,8,10,7,7,9,8,4,7,10,8,7,9,3,11,5,8,5,10,3,7,10,9,6,3,6,5,7,10,3,3,7,7,6,7,8,10,12,7,5,4,3,5,4,4,6,1,6,6,5,5,3,8,4,3,3,5,8,6,6,4,1,3,4,4,6,4,1,4,5,3,6,3,5,1,2,5,9,4,5,3,5,2,5,4,4,2,6,4,4,3,4,3,4,9,4,3,4,2,2,3,3,4,3,3,4,2,3,2,3,2,1,5,1,4,3,5,2,5,4,2,3,3,1,6,3,2,3,3,2,3,1,1,3,2,3,1,2,3,2,6,3,3,2,2,2,1,1,3,3,4,1,1,2,1,1,3,1,2,2,4,2,2,3,3,2,2,1,2,3,1,4,4,1,2,1,1,3,6,3,1,1,2,2,1,2,1,2,1,1,1,2,2,1,1,2,3,1,3,3,2,1,1,3,3,1,2,1,2,2,1,2,3,3,2,1,3,1,2,2,1,1,2,3,1,1,2,2,1,1,2,2,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1,1,1,2,1,1,1,2,1,3,1,2,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,3,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,3,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,375,376,377,378,379,380,381,382,383,385,386,387,388,389,391,392,393,394,395,396,397,398,399,400,402,403,405,406,407,408,409,410,411,413,414,415,416,417,418,419,421,423,424,425,427,428,429,430,431,432,433,435,438,440,442,443,444,445,446,447,448,449,450,452,453,455,456,459,461,462,465,466,467,468,469,470,472,473,475,477,479,481,482,484,489,491,494,495,496,497,498,501,503,505,506,508,511,512,514,515,520,524,526,528,529,530,534,539,540,541,542,545,547,549,551,552,553,558,559,563,569,570,571,573,574,577,584,590,595,596,599,601,604,606,612,614,615,618,619,620,623,624,625,628,632,633,635,639,642,647,653,654,655,656,663,667,681,686,688,696,699,701,703,705,715,716,718,730,740,741,742,744,745,747,751,753,763,767,774,775,786,789,791,792,795,809,822,833,834,835,873,876,897,900,906,916,925,931,941,1002,1047,1048,1073,1075,1079,1125,1184,1201,1249,1273,1282,1393,1399,1406,1454,1549,1591,1592,1633,1649,2090,2205,2217,2387,2503)
pos_uniqRead=c(6296418,1218092,484309,250414,148589,95982,65969,47806,35904,27726,21745,17728,14481,11888,10043,8636,7289,6331,5673,4849,4257,3792,3511,3119,2792,2520,2235,2082,1904,1709,1610,1532,1462,1283,1236,1101,1044,945,919,863,814,769,713,690,656,626,563,540,528,473,451,491,406,382,433,367,417,321,322,319,313,266,289,277,261,275,242,244,238,220,216,197,198,185,150,183,176,156,192,147,150,173,131,133,137,125,125,124,121,126,131,114,95,110,101,86,104,97,81,82,70,84,77,88,63,78,70,85,57,83,69,62,61,48,64,56,55,67,61,60,53,69,54,49,51,48,37,62,50,45,46,49,32,41,43,50,32,35,31,34,46,37,35,40,41,36,38,31,30,30,40,17,32,24,40,27,34,36,26,26,19,29,19,27,30,30,32,16,29,18,29,19,20,21,21,12,19,23,13,18,16,19,24,14,20,21,14,15,17,18,15,20,14,12,14,14,21,17,11,13,13,11,5,16,11,17,16,14,11,10,8,12,12,10,14,15,17,18,7,9,14,10,17,10,13,8,8,7,11,10,12,6,3,10,7,7,6,8,6,7,4,6,9,6,7,8,9,4,9,5,6,8,8,5,8,4,4,7,5,4,10,7,5,2,12,7,12,6,4,5,6,7,5,3,2,6,8,3,4,4,4,3,5,3,3,4,1,4,6,6,3,5,3,2,5,6,4,5,2,6,2,3,1,7,6,4,6,2,4,6,3,4,8,6,1,5,2,2,3,3,4,3,4,4,5,6,4,4,5,4,2,4,2,2,1,3,4,2,1,1,3,3,3,3,5,7,1,5,3,3,2,2,2,3,2,6,1,4,3,2,1,3,1,3,2,3,2,4,3,1,2,3,3,2,3,1,3,1,2,5,1,1,1,4,2,2,1,2,1,3,2,3,2,2,2,2,2,2,4,4,2,1,2,1,3,1,1,2,4,3,1,1,1,3,3,2,1,2,2,3,2,2,2,2,2,1,1,1,1,3,2,1,1,1,3,1,3,3,2,1,2,1,2,3,3,2,3,3,2,1,1,1,2,3,1,2,1,1,1,2,1,1,1,2,2,1,1,3,4,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,3,1,1,2,1,1,1,1,1,1,1,3,1,2,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,2,1,4,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,2,2,1,1,1,1,3,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
