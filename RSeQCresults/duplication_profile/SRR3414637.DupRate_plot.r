pdf('RSeQCresults/duplication_profile/SRR3414637.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,424,425,426,427,428,429,430,432,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,454,455,456,458,459,460,461,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,489,490,492,493,494,495,497,498,501,502,503,505,506,507,508,509,510,511,512,513,514,515,516,518,519,521,522,523,526,528,530,531,532,533,535,537,538,539,541,542,544,545,546,547,548,551,552,553,554,556,557,558,559,560,561,562,565,567,568,569,570,572,573,574,575,577,578,579,580,581,582,583,585,586,588,589,590,592,593,594,595,597,598,599,600,601,603,604,605,608,612,613,616,618,621,622,624,627,631,635,636,638,639,641,642,643,644,645,648,654,656,657,660,661,663,665,667,668,670,675,676,677,679,680,684,685,686,691,692,693,695,697,699,704,706,707,709,710,712,714,715,716,718,720,722,726,727,728,730,733,734,736,737,739,740,741,742,744,745,747,748,754,755,760,762,764,765,766,768,769,771,775,776,780,783,784,792,803,805,806,807,809,812,813,816,819,821,823,827,831,832,834,841,849,852,853,858,860,861,862,864,865,867,872,876,878,880,881,895,896,899,902,903,914,916,918,919,921,924,926,927,929,930,938,939,942,945,948,952,960,963,965,967,968,973,974,975,989,992,995,1008,1018,1025,1031,1045,1051,1067,1070,1078,1082,1087,1104,1120,1128,1134,1135,1136,1146,1157,1172,1184,1195,1235,1245,1258,1259,1266,1286,1287,1317,1320,1331,1355,1394,1395,1411,1419,1434,1449,1509,1526,1537,1552,1580,1597,1639,1675,1694,1698,1709,1720,1753,1756,1917,1921,2051,2055,2098,2190,2258,2265,2431,2618,2676,3121,4291)
seq_uniqRead=c(5363294,1075119,413019,215699,131687,87925,61774,45811,34959,27312,22059,18238,15043,12671,10736,9218,8099,6984,6133,5372,4973,4449,3823,3553,3319,2945,2682,2446,2256,2222,1917,1825,1687,1579,1503,1359,1288,1257,1134,1082,984,967,898,872,794,801,752,685,675,645,605,533,590,539,471,422,475,453,412,414,378,377,380,347,303,348,310,302,249,312,280,262,280,242,220,230,218,231,204,210,183,186,167,181,158,162,171,174,129,150,135,144,135,134,138,130,104,128,112,113,115,131,115,113,101,105,90,109,100,91,102,90,82,88,85,79,85,69,84,79,70,79,85,52,68,71,81,72,83,56,65,64,54,61,68,50,46,46,65,60,61,42,42,47,47,47,63,44,55,36,47,46,38,45,37,53,42,37,43,41,35,27,45,32,34,28,32,25,36,27,34,34,26,35,36,20,31,29,32,25,18,38,21,32,26,20,25,25,32,22,20,21,19,19,31,19,24,25,23,18,20,32,14,30,16,25,24,18,14,15,14,14,17,13,14,18,18,13,18,15,15,22,16,14,16,14,12,16,11,10,16,13,14,13,14,11,15,16,7,19,10,11,8,9,12,21,13,13,12,13,11,14,11,17,5,8,12,9,12,15,10,8,11,12,11,15,11,10,8,6,8,7,9,7,5,5,8,7,7,14,9,8,7,7,4,4,7,5,9,6,6,8,8,10,4,5,4,3,6,5,4,5,8,3,5,4,8,4,9,5,9,13,4,5,9,6,4,10,10,5,6,5,6,8,12,3,11,1,5,5,6,7,5,7,4,7,12,7,5,3,4,4,8,4,1,2,10,6,6,7,7,6,7,2,5,5,9,5,4,3,3,1,7,1,5,2,8,8,1,8,5,2,2,4,4,6,3,7,6,2,3,4,6,5,4,2,4,1,5,7,4,4,1,3,3,1,6,3,3,5,4,4,2,1,3,4,3,6,4,1,5,2,4,3,3,2,3,1,2,3,1,4,3,1,4,4,2,1,5,2,5,4,5,3,2,3,1,4,1,1,4,7,2,2,3,3,1,2,4,5,4,1,2,2,3,1,4,2,3,2,3,4,2,5,4,4,2,6,4,1,2,3,2,1,3,2,2,4,1,2,2,1,1,1,1,2,2,2,1,3,3,1,4,2,1,1,3,4,1,1,2,3,4,1,1,2,3,2,3,1,1,1,3,2,5,1,1,2,2,2,3,1,2,5,1,2,1,2,2,1,2,2,4,1,1,1,1,1,2,1,1,3,1,3,1,2,2,1,3,1,1,1,3,2,1,5,2,1,2,2,1,2,1,1,2,1,1,2,2,1,1,1,1,1,1,2,1,2,1,1,1,2,2,1,2,3,2,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,2,1,1,1,1,3,1,2,2,1,1,3,1,2,2,1,2,1,1,2,2,2,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1,2,1,1,1,1,4,1,1,1,1,1,1,2,1,2,1,1,1,2,1,1,2,2,1,1,1,2,1,1,1,1,1,1,1,1,1,2,2,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,436,437,438,439,440,442,443,444,446,447,448,449,450,451,452,453,454,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,475,476,477,478,479,480,481,482,484,485,486,487,488,489,490,491,492,493,495,496,497,498,500,501,502,503,504,505,506,508,509,511,512,513,514,515,516,517,519,520,521,522,524,525,526,527,528,529,530,531,532,533,535,536,537,539,541,543,546,547,548,549,550,551,552,554,555,556,558,559,560,563,564,565,567,568,570,575,576,577,578,579,580,581,585,587,588,589,590,592,594,595,596,597,598,599,601,602,603,604,606,607,609,611,612,613,614,616,617,619,621,622,623,627,628,631,633,638,640,641,642,643,644,645,648,651,654,657,658,659,661,662,663,667,670,671,672,673,674,676,680,681,683,688,691,694,697,700,702,706,708,709,710,711,712,713,714,718,720,721,722,723,730,731,732,734,736,737,739,740,741,743,746,747,748,750,752,753,755,758,764,765,768,771,776,778,782,784,785,786,787,789,790,792,793,795,796,798,800,802,805,817,822,824,829,830,832,833,835,840,843,844,851,852,853,856,857,858,859,860,865,866,868,870,876,879,882,886,887,890,891,892,896,897,902,905,910,913,922,924,925,926,937,943,952,953,955,958,959,960,964,965,967,973,977,979,980,981,985,987,994,997,998,999,1000,1002,1008,1014,1018,1040,1042,1069,1085,1088,1089,1091,1102,1107,1116,1117,1132,1141,1159,1168,1172,1181,1185,1194,1202,1226,1229,1276,1289,1296,1313,1323,1336,1357,1358,1391,1424,1440,1454,1455,1463,1494,1498,1553,1570,1590,1593,1633,1689,1705,1735,1743,1763,1783,1800,1810,1817,1977,1989,2117,2134,2173,2176,2263,2345,2347,2515,2734,2830,3227,4427)
pos_uniqRead=c(4696660,1089148,427655,224729,137713,91907,65062,48250,36879,28996,23200,19433,15856,13536,11459,9812,8508,7456,6485,5788,5240,4705,4120,3709,3515,3180,2849,2639,2399,2259,2092,1939,1799,1662,1626,1412,1392,1332,1293,1163,1056,1066,949,923,887,798,765,736,721,685,638,606,595,545,544,519,504,473,446,435,384,389,358,429,350,331,308,353,309,289,279,306,310,250,253,238,229,220,209,254,234,182,217,163,195,155,164,169,157,163,159,174,136,138,138,136,143,126,106,126,122,119,118,125,112,111,112,94,96,115,116,90,113,92,100,76,77,85,83,68,84,87,71,83,85,76,70,74,71,63,67,69,70,68,51,66,70,57,50,66,59,58,63,61,42,44,53,47,43,46,58,54,41,48,42,35,48,47,53,45,39,37,48,36,34,35,33,54,33,38,32,25,42,30,37,22,25,32,36,28,31,38,31,25,19,31,24,27,25,25,19,28,23,28,19,31,17,19,30,23,25,19,27,23,24,11,21,28,32,19,22,21,20,14,27,10,17,18,10,16,18,15,15,18,18,21,10,17,15,20,8,8,14,18,18,16,13,11,11,10,15,13,8,12,8,13,13,8,14,15,9,13,16,13,9,15,17,6,19,9,8,13,14,10,10,12,14,15,15,9,11,8,11,10,5,11,11,13,5,8,11,8,4,10,10,6,8,6,11,7,10,1,10,3,5,8,5,5,12,8,7,6,9,10,7,6,5,5,6,7,2,4,8,8,3,7,4,6,6,9,5,7,2,12,9,3,4,13,7,6,4,7,7,5,3,4,6,5,2,8,7,8,6,12,7,6,10,4,6,11,6,4,2,3,8,6,2,6,1,6,5,4,6,3,6,6,7,9,3,6,7,4,4,3,7,5,5,4,8,1,1,7,3,4,4,2,6,1,3,7,2,3,9,2,3,4,2,7,4,7,5,5,2,5,3,4,4,3,2,4,3,3,5,3,4,1,4,1,2,5,1,6,5,3,2,4,2,4,1,3,1,3,5,2,2,3,4,4,1,5,3,2,6,4,3,1,3,1,3,3,2,4,4,5,2,1,1,4,2,3,3,4,1,1,7,3,1,2,1,5,2,2,2,1,4,2,3,8,2,4,2,4,6,2,4,4,1,3,2,2,2,1,4,2,2,3,1,1,4,2,1,2,2,2,2,2,4,1,3,2,3,1,1,1,2,1,1,4,2,1,1,2,1,2,1,3,2,2,3,2,3,1,2,2,2,2,1,1,1,2,2,5,3,2,2,5,2,3,4,2,1,3,2,1,2,1,2,3,1,2,1,2,3,1,3,1,1,1,1,3,1,2,2,3,2,1,2,1,4,2,2,1,3,2,2,1,1,1,1,3,1,1,1,3,1,2,2,2,1,1,2,1,1,1,1,3,1,1,1,3,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,2,1,2,3,1,3,1,1,1,1,2,1,4,1,1,2,2,1,2,1,1,3,1,1,1,3,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,1,1,1,2,2,1,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
