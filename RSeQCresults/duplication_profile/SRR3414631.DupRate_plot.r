pdf('RSeQCresults/duplication_profile/SRR3414631.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,335,336,337,338,339,340,341,342,343,344,346,347,348,349,350,351,352,353,354,355,356,357,358,359,362,363,364,365,367,368,369,370,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,390,393,394,395,396,399,400,401,404,405,406,407,408,409,410,411,412,414,415,416,417,418,419,420,421,422,425,426,427,428,431,433,435,436,437,438,439,440,441,442,443,444,445,448,449,450,451,452,454,455,457,459,462,463,464,468,472,473,474,476,477,478,479,480,481,482,485,486,488,489,492,495,499,500,501,504,505,507,508,509,510,511,512,513,514,515,517,518,519,523,527,528,530,531,532,534,536,537,538,540,541,544,545,546,547,550,551,554,556,560,561,563,564,566,570,573,574,575,576,578,579,581,584,585,586,588,589,591,592,593,597,599,600,601,602,603,606,612,619,624,625,627,628,634,640,641,642,646,648,652,657,663,666,668,669,673,674,679,680,686,688,690,704,706,707,708,712,716,718,720,726,727,731,739,742,746,751,754,755,756,767,770,783,784,785,787,796,797,800,801,803,810,824,829,832,833,835,848,851,854,855,862,865,877,904,923,927,928,929,946,953,954,982,987,1006,1008,1011,1020,1036,1064,1095,1134,1143,1146,1154,1203,1296,1350,1360,1379,1515,1552,1619,1655,1673,1709,1860,1955,2102,2280,2295,2310,2908)
seq_uniqRead=c(7612641,1311550,529856,277440,165929,107016,73920,53584,40168,31182,24505,19904,15989,13278,11107,9394,8174,7072,6091,5336,4777,4257,3872,3422,2965,2816,2521,2220,2188,1897,1913,1689,1572,1470,1319,1213,1168,1062,987,916,855,870,795,784,751,675,631,579,589,506,485,510,492,440,422,437,380,391,380,367,316,328,319,302,304,272,264,258,250,222,227,228,213,230,228,176,196,193,198,155,174,157,173,150,121,131,127,138,140,121,128,125,122,97,108,104,104,107,96,98,94,101,81,88,87,88,68,96,77,74,69,78,70,54,74,67,57,56,67,66,65,75,50,60,55,49,48,62,48,55,51,34,46,49,43,48,48,47,32,43,45,36,36,44,47,41,32,29,47,44,41,25,36,29,34,29,20,47,21,32,25,24,24,27,25,24,34,21,29,29,27,28,27,29,25,21,25,20,22,25,15,26,15,29,25,24,23,15,16,14,9,18,14,16,16,19,14,10,24,13,19,16,15,18,22,12,15,17,11,12,20,13,16,12,18,15,10,17,9,9,8,9,8,9,6,12,11,5,13,13,3,11,10,15,10,9,9,8,11,13,13,15,10,13,9,5,6,3,7,4,5,5,9,6,6,7,9,9,8,8,5,6,9,6,6,2,5,9,7,5,7,6,6,3,2,11,7,5,5,7,10,7,4,4,3,5,7,5,8,11,8,4,6,6,6,4,5,3,6,3,8,2,5,4,6,5,4,4,3,5,1,3,2,2,8,5,4,4,1,9,6,2,2,5,7,3,7,2,5,3,5,3,4,7,5,3,5,4,2,5,2,2,6,3,2,4,2,4,2,7,4,3,5,2,3,4,2,3,4,2,1,4,3,1,3,3,2,4,2,1,1,3,1,1,2,2,3,4,2,1,2,3,6,4,3,2,3,2,2,1,1,4,2,6,3,1,1,4,2,2,3,3,1,1,1,1,3,2,2,1,2,2,1,2,4,2,4,1,1,1,2,2,1,1,1,1,1,2,2,1,1,1,1,2,1,1,4,2,3,1,3,2,1,2,1,2,2,1,1,3,1,1,2,1,1,1,2,1,2,3,1,2,1,1,2,1,2,1,2,1,3,1,1,1,2,1,4,1,1,1,2,1,2,1,1,1,2,1,1,1,1,1,2,3,1,2,2,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,2,1,2,1,1,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,2,1,1,1,2,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,368,369,370,371,373,375,376,377,378,379,381,382,383,384,385,386,387,388,389,390,391,393,394,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,417,418,419,421,422,423,424,425,426,427,428,430,431,432,433,435,436,437,438,439,440,443,444,446,447,448,450,451,453,454,455,456,457,458,459,460,461,462,464,466,467,469,470,471,473,475,476,477,480,481,482,486,489,490,491,492,494,495,497,498,499,501,502,504,505,506,507,512,516,517,518,520,521,523,524,525,526,527,529,530,534,535,536,537,539,540,542,545,546,547,548,550,551,552,555,559,560,561,563,565,566,570,571,572,573,574,576,578,581,585,586,588,590,591,593,594,596,599,602,603,604,607,610,612,616,618,619,620,621,622,623,626,629,630,631,640,644,645,646,647,648,650,654,660,661,664,668,672,673,675,680,683,685,689,698,702,703,708,719,720,721,723,733,735,740,742,744,746,748,753,759,772,774,775,777,781,782,789,790,798,806,809,812,816,819,820,822,824,825,832,838,839,841,850,851,852,864,865,877,886,887,889,892,901,905,936,953,956,963,979,988,995,1006,1032,1040,1057,1058,1070,1119,1121,1138,1174,1178,1179,1180,1183,1253,1394,1398,1410,1476,1568,1617,1682,1705,1742,1763,1967,2016,2184,2352,2358,2379,2992)
pos_uniqRead=c(6795234,1351157,553478,290890,175146,113855,78643,57194,42934,33262,26123,21162,17442,14235,12000,10089,8752,7672,6616,5701,5231,4560,4100,3692,3264,2997,2757,2499,2277,2062,1938,1799,1714,1543,1474,1343,1267,1145,1070,1086,928,857,832,839,803,741,689,651,633,568,586,517,494,471,479,435,448,404,376,373,378,338,373,306,317,296,284,266,260,257,261,228,226,244,221,216,231,203,198,189,192,163,180,154,161,155,160,148,132,148,113,140,113,122,123,112,99,130,110,103,92,105,108,87,89,71,97,87,81,71,88,75,73,82,69,69,58,82,64,67,66,53,57,63,76,64,48,51,62,64,54,52,55,49,45,40,44,45,45,46,56,28,37,49,47,39,43,46,38,42,50,44,39,39,29,31,34,29,29,26,42,28,23,24,34,26,24,27,24,21,30,28,29,25,26,28,28,31,26,23,21,24,23,25,24,28,20,19,15,19,26,24,22,17,18,18,13,14,21,14,19,9,14,15,22,24,11,13,18,19,23,10,10,15,16,16,11,14,19,17,13,15,12,16,18,11,11,6,13,5,8,8,10,9,11,10,8,11,15,9,7,10,9,8,11,14,10,14,9,4,7,9,12,12,10,9,7,8,6,6,4,6,9,2,9,8,14,6,7,9,9,9,2,5,7,6,7,3,8,5,3,4,4,4,3,10,6,4,11,5,2,7,7,4,7,5,3,7,8,5,2,7,9,8,10,7,4,6,6,3,5,7,4,5,4,1,4,2,5,2,3,4,7,6,5,1,3,5,2,3,3,4,8,9,3,3,9,8,4,3,4,4,4,2,2,3,4,5,2,4,4,2,5,3,3,4,1,5,3,3,3,3,3,2,3,3,2,4,4,3,3,4,2,4,2,4,2,3,3,1,2,3,4,4,2,1,2,4,4,4,1,3,2,2,2,3,1,2,2,3,1,1,2,3,1,1,1,1,2,2,4,2,5,1,2,1,5,1,2,2,3,1,1,1,3,3,3,2,1,2,1,1,1,2,2,2,1,2,3,2,2,1,2,1,1,2,2,2,1,1,1,1,1,2,1,1,2,1,1,3,1,2,1,2,4,1,1,1,1,1,4,1,1,1,1,2,1,1,1,3,2,2,2,1,1,1,3,1,2,4,1,1,1,1,1,1,2,2,1,2,1,2,2,2,1,1,2,1,1,1,1,1,2,1,1,1,2,1,2,2,1,3,1,2,1,1,1,1,1,2,1,1,1,1,2,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,3,1,2,1,2,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
