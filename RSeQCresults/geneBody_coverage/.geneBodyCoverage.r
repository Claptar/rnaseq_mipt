SRR3414637_sorted <- c(0.0,0.015512238672717804,0.0531675470575106,0.09565880514842645,0.13473699873521316,0.18772784763038464,0.23882151625623094,0.29595082211145,0.3493415668477048,0.3998958410832527,0.4375232497582025,0.4770664385090395,0.49981400193437986,0.5217524737742727,0.5622628524663343,0.5866471988691317,0.6322353247526226,0.6625623093519828,0.6887787367011383,0.7121679934528681,0.7263782456662451,0.7282754259355703,0.7406349973960271,0.7684324083029537,0.8103098727773231,0.8219254519752994,0.8431478312625549,0.8701826501004389,0.8627241276690722,0.8510062495350048,0.8620266349229968,0.8510434491481289,0.883025816531508,0.8772970761104084,0.8849136968975523,0.9045085931106317,0.8761066884904397,0.9171843612826427,0.9244289859385463,0.9311435161074325,0.9442005803139647,0.9323525035339633,0.9244754854549513,0.9816233911167324,0.9624934900677034,0.9693382188825236,0.9566159511941076,0.9918997842422439,0.9973402276616323,0.9662506509932297,0.9331894948292537,0.9698125139498549,0.9349843761624879,0.9072520645785284,0.941550107878878,0.9765642437318652,0.9596198199538725,0.9662041514768246,0.9405829179376535,0.9409735138754557,0.9492318279889889,0.9437541849564764,0.9564392530317685,0.9681013317461499,0.9599732162785507,0.9443121791533368,0.9601127148277658,0.9597407186965256,0.9881612231232795,0.9689011234283164,0.9854642511717878,0.9545420727624433,0.9498642214120974,0.9633583810728369,0.9765921434417082,0.966864444609776,0.9892679116137192,0.9733650770031992,0.9709471021501377,0.9791682166505469,1.0,0.9798564094933413,0.9757086526300126,0.9641674726582844,0.9144222900081839,0.8785246633435012,0.8699036530020088,0.9003887359571461,0.8937951045309129,0.8563071944051782,0.8530243285469831,0.8218138531359274,0.8044416338070084,0.7915891674726583,0.7421415817275501,0.6949724722862882,0.6302823450636114,0.5557343203630682,0.43195260769288,0.270543486347742)
SRR3414630_sorted <- c(0.0,0.016483316995243802,0.057873143811494755,0.10410388604485109,0.14975371842815477,0.19940940831911314,0.24807271054956492,0.3048808529692965,0.3640610439434097,0.4171416814919701,0.45434411647242495,0.5010105410933208,0.5228793764900943,0.5459826453182297,0.5743262050853817,0.6028270946035895,0.6477628919628702,0.6797371382928512,0.6986167084195621,0.7248302654031877,0.7506807537305304,0.7485628532355468,0.7520725169129482,0.7985816117827881,0.8329400089556935,0.8514807150032071,0.8596013506154013,0.8657493131951252,0.8759515424366747,0.8702271599559477,0.8813249585496618,0.8624453884229508,0.890571106996333,0.8929189509736292,0.8934151448038824,0.9109513609023466,0.8953031018165535,0.9296736012780017,0.936354064553607,0.9401420808674921,0.9460722022534461,0.9420784470343342,0.9326265596824359,0.9741374093841145,0.961684154473611,0.9703614953587724,0.9631727359643708,0.9980999406987862,1.0,0.9562986360720812,0.9251110384973799,0.9531762456280483,0.9303755340134819,0.8994420844981786,0.9282092243643273,0.9576782969659563,0.9429619140979559,0.9348049716201333,0.9206452940251001,0.9229084219825969,0.9257282552130608,0.9185152912415738,0.9369107698265742,0.9542412470198115,0.9294315555071464,0.9183458592019751,0.9449708939960546,0.9324571276428373,0.9569037504992194,0.9336310496314854,0.9482990233453146,0.9165789250747316,0.9048276028997083,0.9095353931428433,0.9193019399968534,0.9233441043701364,0.9288990548112648,0.9164215953236757,0.9168451754226724,0.9222791029783732,0.9403236151956335,0.9337036633627419,0.9268537680475378,0.9049002166309649,0.8634619806605429,0.8347916591027363,0.8277239225937625,0.8507666799791841,0.8402739958126082,0.7943337085042782,0.8030231516779823,0.7740744774836922,0.7518667780077213,0.730034249476576,0.6845054399787,0.6359752629222186,0.5775575161262995,0.5042418521342386,0.39492187972745646,0.25114669183942684)
SRR3414631_sorted <- c(0.0,0.025823905558288243,0.07953613856220841,0.1402167270342381,0.19940675818688608,0.2539238921432724,0.29739599636304015,0.3520770916245584,0.4030541519474131,0.4584134507892501,0.4949619162604898,0.5428684285054182,0.5607625691245957,0.5815483909433737,0.6170311079312555,0.6410216279867043,0.6823249713067716,0.69346688726915,0.7188138144852361,0.7505626853880666,0.7669140991816841,0.7651925054777982,0.7661688205219932,0.8032613394148072,0.8356884138979565,0.8496325776207724,0.8565785747290912,0.8678993575697953,0.8786313702693437,0.8796971187527016,0.894259863763061,0.86629700845146,0.8951169342217055,0.8970993754564832,0.908360536004412,0.9275589142780486,0.9198229217904574,0.9389169610517373,0.9466305951795376,0.9506252887954806,0.9437910834861155,0.9297574863241366,0.9294370165004695,0.9589500514242275,0.9539268732579111,0.9693019720073336,0.9611486234703156,0.9849379182876478,1.0,0.9752865596446512,0.9361594300108811,0.9512811340160086,0.9368898030973781,0.8985750272026711,0.9299363532024624,0.9509457586191477,0.9340055746843745,0.9297723918973304,0.9324255839258299,0.934624155971918,0.9428967490944864,0.9326342619505433,0.9514376425345437,0.973177421037726,0.94064600754222,0.9328131288288691,0.9677219812487889,0.949134731476099,0.9647259610368317,0.9318964360774493,0.9416968504523842,0.9206427283161174,0.911296933923594,0.9118409873451684,0.9316728524795421,0.9406087436092355,0.939021300064094,0.9211718761644979,0.9242126130960366,0.940809968847352,0.9478379466082368,0.9470330456557707,0.9308455931672852,0.9137041839943955,0.8778562804632652,0.8508473818360686,0.8499455946578426,0.8703960410797598,0.8463458987315358,0.8098570555530713,0.8181371014622367,0.786977000700562,0.7600277243661405,0.7313792126876238,0.6856563669155897,0.6298349953047444,0.5587428639568335,0.47875955819881055,0.35650404686312215,0.22985139143525765)
SRR3414635_sorted <- c(0.0,0.024624211545596873,0.0800626238676573,0.14493081510574565,0.2023420602528484,0.264558691776545,0.30795196423561777,0.3714898507705813,0.4216070442801423,0.4812807123917431,0.5146921747314503,0.5500583705124841,0.5767187627261292,0.5988724083944942,0.6346729893847115,0.6580483434539054,0.7006180939539008,0.7104822580791124,0.7350883702409933,0.759812128397028,0.7758481823693903,0.7792689658917114,0.7752328033230469,0.8063003954715342,0.8432140885602846,0.8489968416575415,0.8641369761359625,0.8723812454185935,0.8783178432774364,0.8875485289725885,0.8925168098026263,0.8761278178478022,0.9070144161591298,0.9012769115211627,0.9063718880372124,0.9355390448955213,0.9261907132062154,0.9385706916679487,0.9505615333797884,0.945240314567289,0.9387516855051086,0.9298829874842761,0.9205075067193962,0.9634482945855694,0.9598374675342305,0.9738735396059764,0.9632492013646935,0.9698826254966019,1.0,0.9818644175165836,0.9404620772662691,0.9512764590365698,0.9356476411978172,0.9015936507361925,0.9337291065239228,0.9528692048035764,0.9324711993556619,0.9317381743151646,0.9302992733097438,0.9337110071402068,0.9442176993873359,0.935873883494267,0.9547605904018969,0.9686790164794888,0.9419733758065538,0.93009113039701,0.9527334594257065,0.9464710726599759,0.9564619324711994,0.9314395344838509,0.9504710364612085,0.9191591026325554,0.907955584112361,0.9036388810960987,0.9269237382467127,0.9265074524212451,0.9359734301047049,0.9157111700346603,0.9225889358467344,0.9361725233255808,0.9447516312069574,0.9349598646166098,0.9220369046433969,0.9126523741866589,0.8703179156749713,0.8514040596917675,0.85535877503371,0.8697930335472077,0.8325354521678537,0.7980108777296133,0.803051556094515,0.7697124912896716,0.7462194912263237,0.7174414711179085,0.6770526963556891,0.6190170224703849,0.5456783196532158,0.47585994696880574,0.3558610329318287,0.23015176333245854)
SRR3414636_sorted <- c(0.0,0.025499094219473366,0.07723837581657488,0.14005745759300262,0.19592307270032389,0.25306958956248055,0.2987245878241139,0.3589635674943732,0.4099983531263152,0.464637962268294,0.49987190982451646,0.5332851470292228,0.5578967593185603,0.5798276272209921,0.6181174403923219,0.642637559699171,0.6830774579589746,0.6904700909440246,0.7201778623579571,0.7439477392084027,0.7611575692144412,0.7619810060568354,0.7590257827224652,0.7907829969441343,0.8222474336218412,0.8293106918699336,0.8469139417006716,0.8543980676682098,0.864443997145419,0.873501802411755,0.8807846438178192,0.86256839100441,0.8916174129444272,0.884389467327856,0.8888085783820381,0.9183699610239895,0.9090285275119399,0.9225603396219509,0.9368332448901169,0.93828798331168,0.9330545847133525,0.9181229299712712,0.9129718750571831,0.9491664989295321,0.9535032662994748,0.9654979963036835,0.9576021519149481,0.9667514501637724,1.0,0.9773188896411645,0.9329173452396201,0.9477575069992131,0.9280224706764991,0.889229446101484,0.9174733297956047,0.9380866987502059,0.9222584127797397,0.9241157203242512,0.9158264561108163,0.9191019048838954,0.9343263371699391,0.9270709436586214,0.9420574941901956,0.9541620157733902,0.927821186115025,0.916988416988417,0.9416640743654962,0.9381507438379476,0.9473366392797672,0.9173818368131165,0.9395139892770225,0.9123405734780142,0.900739263298505,0.8983512964555619,0.9214258266390968,0.9281505608519827,0.9285622792731798,0.9075188933008839,0.9143168218997603,0.9307215136599023,0.9378305183992388,0.929696792256034,0.9199710882175337,0.9087997950557192,0.8691467364453146,0.8443887353839961,0.8429522955589306,0.8587714322311478,0.8292649453786894,0.8006276418598693,0.8021830225621694,0.7669948214971911,0.7444326520155904,0.7177990448132628,0.6803784149755714,0.6287031784662116,0.5489304470347124,0.47732803893941333,0.36233965854818934,0.2331424179765412)
SRR3414629_sorted <- c(0.0,0.02743730722810782,0.08778329086764114,0.156121764784766,0.21703991775065934,0.2813642662375397,0.32452728979482365,0.3849000938715301,0.4338116311295874,0.49973626570113094,0.5387600017880292,0.5725626927718922,0.593473693621206,0.6145009163649368,0.6522998524875956,0.678753743686022,0.7169281659291047,0.7178758213758885,0.7443744133029369,0.7807518662554199,0.790997273255554,0.7906843681552009,0.7952974833489785,0.8289839524384247,0.8632425908542309,0.8726029234276519,0.8780742926109696,0.881775512940861,0.892450046935765,0.9036162889455098,0.9023557283983729,0.87270126503062,0.9078270975816906,0.9091681194403469,0.9185910330338385,0.9357471726789147,0.9273613159894506,0.9410397389477448,0.9543873765142372,0.961432211345045,0.9521344597916946,0.9410754995306424,0.938447096687676,0.9646864243887175,0.9568548567341648,0.9709981672701266,0.9641142550623575,0.9728308971436235,1.0,0.9824683742345001,0.9399311608779223,0.9510884627419427,0.9395467346117742,0.9057082830450136,0.9319386706003308,0.9527513298466765,0.9327164632783514,0.9258593715077555,0.9334316749363014,0.9384828572705735,0.9490769299539582,0.9408609360332574,0.9556658173528229,0.9726967949577578,0.9333869742076796,0.9248491350409012,0.9604309150239149,0.9437307228107819,0.9539671896651916,0.9176076170041572,0.9322873362835814,0.9039202539001385,0.8890974922891243,0.8919493987752001,0.9065128961602074,0.9154530418845828,0.9147288900809083,0.8967413168834653,0.9015689955746279,0.915220598095749,0.9193688257118591,0.9120110857806982,0.8963121898886952,0.8821867596441823,0.8506727459657593,0.8306199991059854,0.8312815698895892,0.8467301417013098,0.8147870010281167,0.7775512940860936,0.7817442224308256,0.752286442269009,0.7263600196683206,0.6955254570649502,0.6573867954047651,0.60128738098431,0.530561888158777,0.4606141880112646,0.3470385767288007,0.22422779491305708)
data_matrix <- matrix(c(SRR3414637_sorted,SRR3414630_sorted,SRR3414631_sorted,SRR3414635_sorted,SRR3414636_sorted,SRR3414629_sorted), byrow=T, ncol=100)
rowLabel <- c("SRR3414637_sorted","SRR3414630_sorted","SRR3414631_sorted","SRR3414635_sorted","SRR3414636_sorted","SRR3414629_sorted")


pdf("RSeQCresults/geneBody_coverage/.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("RSeQCresults/geneBody_coverage/.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(6)
plot(x,SRR3414637_sorted,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,SRR3414630_sorted,type='l',col=icolor[2])
lines(x,SRR3414631_sorted,type='l',col=icolor[3])
lines(x,SRR3414635_sorted,type='l',col=icolor[4])
lines(x,SRR3414636_sorted,type='l',col=icolor[5])
lines(x,SRR3414629_sorted,type='l',col=icolor[6])
legend(0,1,fill=icolor[1:6], legend=c('SRR3414637_sorted','SRR3414630_sorted','SRR3414631_sorted','SRR3414635_sorted','SRR3414636_sorted','SRR3414629_sorted'))
dev.off()
